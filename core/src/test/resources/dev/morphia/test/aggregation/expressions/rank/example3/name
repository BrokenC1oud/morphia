Rank Partitions Containing Duplicate Values, Nulls, or Missing Data
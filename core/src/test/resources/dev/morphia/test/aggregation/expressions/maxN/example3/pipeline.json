[
   {
      $group:
      {
         _id: {"gameId": "$gameId"},
         gamescores:
            {
               $maxN:
                  {
                     input: ["$score","$playerId"],
                     n: { $cond: { if: {$eq: ["$gameId","G2"] }, then: 1, else: 3 } }
                  }
            }
      }
   }
] 
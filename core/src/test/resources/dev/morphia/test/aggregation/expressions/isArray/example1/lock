use a different form of $isArray to match morphia's rendering
use shorter form of cond